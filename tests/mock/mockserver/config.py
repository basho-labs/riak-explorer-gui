
def send_response(requestHandler, payload, content_type):
    requestHandler.send_response(200)
    requestHandler.send_header('Content-type', content_type)
    requestHandler.end_headers()
    requestHandler.wfile.write(payload)
    requestHandler.wfile.close()

def test(requestHandler):
    payload = "test"
    send_response(requestHandler, payload, 'application/json')

def clusters(requestHandler):
    payload = '{"clusters":[{"id":"default","riak_node":"riak@127.0.0.1","development_mode":true}],"links":{"self":"/explore/clusters"}}'
    send_response(requestHandler, payload, 'application/json')

def indexes(requestHandler):
    payload = '[{"name":"sendgrid","n_val":3,"schema":"sendgrid"},{"name":"yz_err","n_val":3,"schema":"_yz_default"},{"name":"my_index","n_val":3,"schema":"_yz_default"}]'
    send_response(requestHandler, payload, 'application/json')

def nodes(requestHandler):
    payload = '{"nodes":[{"id":"riak@127.0.0.1"}],"links":{"self":"/explore/clusters/default/nodes"}}'
    send_response(requestHandler, payload, 'application/json')

def bucket_types(requestHandler):
    payload = '{"bucket_types":[{"id":"default","props":{"active":true,"allow_mult":false,"basic_quorum":false,"big_vclock":50,"chash_keyfun":"{riak_core_util,chash_std_keyfun}","dvv_enabled":false,"dw":"quorum","last_write_wins":false,"linkfun":"{modfun,riak_kv_wm_link_walker,mapreduce_linkfun}","n_val":3,"notfound_ok":true,"old_vclock":86400,"postcommit":[],"pr":0,"precommit":[],"pw":0,"r":"quorum","rw":"quorum","small_vclock":50,"w":"quorum","write_once":false,"young_vclock":20}},{"id":"yz_err","props":{"active":true,"allow_mult":false,"basic_quorum":false,"big_vclock":50,"chash_keyfun":"{riak_core_util,chash_std_keyfun}","claimant":"\'riak@127.0.0.1\'","dvv_enabled":true,"dw":"quorum","last_write_wins":false,"linkfun":"{modfun,riak_kv_wm_link_walker,mapreduce_linkfun}","n_val":3,"notfound_ok":true,"old_vclock":86400,"postcommit":[],"pr":0,"precommit":[],"pw":0,"r":"quorum","rw":"quorum","search_index":"yz_err","small_vclock":50,"w":"quorum","young_vclock":20}},{"id":"recipients","props":{"young_vclock":20,"w":"quorum","small_vclock":50,"search_index":"my_index","rw":"quorum","r":"quorum","pw":0,"precommit":[],"pr":0,"postcommit":[],"old_vclock":86400,"notfound_ok":true,"n_val":3,"linkfun":"{modfun,riak_kv_wm_link_walker,mapreduce_linkfun}","last_write_wins":false,"dw":"quorum","dvv_enabled":true,"chash_keyfun":"{riak_core_util,chash_std_keyfun}","big_vclock":50,"basic_quorum":false,"allow_mult":true,"datatype":"map","active":true,"claimant":"\'riak@127.0.0.1\'"}},{"id":"sendgrid","props":{"young_vclock":20,"w":"quorum","small_vclock":50,"search_index":"sendgrid","rw":"quorum","r":"quorum","pw":0,"precommit":[],"pr":0,"postcommit":[],"old_vclock":86400,"notfound_ok":true,"n_val":3,"linkfun":"{modfun,riak_kv_wm_link_walker,mapreduce_linkfun}","last_write_wins":false,"dw":"quorum","dvv_enabled":true,"chash_keyfun":"{riak_core_util,chash_std_keyfun}","big_vclock":50,"basic_quorum":false,"allow_mult":true,"active":true,"claimant":"\'riak@127.0.0.1\'"}}],"links":{"self":"/explore/clusters/default/bucket_types"}}'
    send_response(requestHandler, payload, 'application/json')

def riak_ping(requestHandler):
    payload = 'OK'
    send_response(requestHandler, payload, 'text/html')

def riak_stats(requestHandler):
    payload = '{"connected_nodes":["riak_explorer@127.0.0.1"],"consistent_get_objsize_100":0,"consistent_get_objsize_95":0,"consistent_get_objsize_99":0,"consistent_get_objsize_mean":0,"consistent_get_objsize_median":0,"consistent_get_time_100":0,"consistent_get_time_95":0,"consistent_get_time_99":0,"consistent_get_time_mean":0,"consistent_get_time_median":0,"consistent_gets":0,"consistent_gets_total":0,"consistent_put_objsize_100":0,"consistent_put_objsize_95":0,"consistent_put_objsize_99":0,"consistent_put_objsize_mean":0,"consistent_put_objsize_median":0,"consistent_put_time_100":0,"consistent_put_time_95":0,"consistent_put_time_99":0,"consistent_put_time_mean":0,"consistent_put_time_median":0,"consistent_puts":0,"consistent_puts_total":0,"converge_delay_last":0,"converge_delay_max":0,"converge_delay_mean":0,"converge_delay_min":0,"coord_redirs_total":0,"counter_actor_counts_100":0,"counter_actor_counts_95":0,"counter_actor_counts_99":0,"counter_actor_counts_mean":0,"counter_actor_counts_median":0,"cpu_avg1":507,"cpu_avg15":486,"cpu_avg5":530,"cpu_nprocs":364,"dropped_vnode_requests_total":0,"executing_mappers":0,"gossip_received":0,"handoff_timeouts":0,"ignored_gossip_total":0,"index_fsm_active":0,"index_fsm_create":0,"index_fsm_create_error":0,"late_put_fsm_coordinator_ack":0,"leveldb_read_block_error":0,"list_fsm_active":0,"list_fsm_create":0,"list_fsm_create_error":0,"list_fsm_create_error_total":0,"list_fsm_create_total":0,"map_actor_counts_100":0,"map_actor_counts_95":0,"map_actor_counts_99":0,"map_actor_counts_mean":0,"map_actor_counts_median":0,"mem_allocated":12236386304,"mem_total":12865118208,"memory_atom":602729,"memory_atom_used":573995,"memory_binary":4679816,"memory_code":14209475,"memory_ets":7858376,"memory_processes":46894016,"memory_processes_used":46891480,"memory_system":45938304,"memory_total":92832320,"node_get_fsm_active":0,"node_get_fsm_active_60s":0,"node_get_fsm_counter_objsize_100":0,"node_get_fsm_counter_objsize_95":0,"node_get_fsm_counter_objsize_99":0,"node_get_fsm_counter_objsize_mean":0,"node_get_fsm_counter_objsize_median":0,"node_get_fsm_counter_siblings_100":0,"node_get_fsm_counter_siblings_95":0,"node_get_fsm_counter_siblings_99":0,"node_get_fsm_counter_siblings_mean":0,"node_get_fsm_counter_siblings_median":0,"node_get_fsm_counter_time_100":0,"node_get_fsm_counter_time_95":0,"node_get_fsm_counter_time_99":0,"node_get_fsm_counter_time_mean":0,"node_get_fsm_counter_time_median":0,"node_get_fsm_errors":0,"node_get_fsm_errors_total":0,"node_get_fsm_in_rate":0,"node_get_fsm_map_objsize_100":0,"node_get_fsm_map_objsize_95":0,"node_get_fsm_map_objsize_99":0,"node_get_fsm_map_objsize_mean":0,"node_get_fsm_map_objsize_median":0,"node_get_fsm_map_siblings_100":0,"node_get_fsm_map_siblings_95":0,"node_get_fsm_map_siblings_99":0,"node_get_fsm_map_siblings_mean":0,"node_get_fsm_map_siblings_median":0,"node_get_fsm_map_time_100":0,"node_get_fsm_map_time_95":0,"node_get_fsm_map_time_99":0,"node_get_fsm_map_time_mean":0,"node_get_fsm_map_time_median":0,"node_get_fsm_objsize_100":0,"node_get_fsm_objsize_95":0,"node_get_fsm_objsize_99":0,"node_get_fsm_objsize_mean":0,"node_get_fsm_objsize_median":0,"node_get_fsm_out_rate":0,"node_get_fsm_rejected":0,"node_get_fsm_rejected_60s":0,"node_get_fsm_rejected_total":0,"node_get_fsm_set_objsize_100":0,"node_get_fsm_set_objsize_95":0,"node_get_fsm_set_objsize_99":0,"node_get_fsm_set_objsize_mean":0,"node_get_fsm_set_objsize_median":0,"node_get_fsm_set_siblings_100":0,"node_get_fsm_set_siblings_95":0,"node_get_fsm_set_siblings_99":0,"node_get_fsm_set_siblings_mean":0,"node_get_fsm_set_siblings_median":0,"node_get_fsm_set_time_100":0,"node_get_fsm_set_time_95":0,"node_get_fsm_set_time_99":0,"node_get_fsm_set_time_mean":0,"node_get_fsm_set_time_median":0,"node_get_fsm_siblings_100":0,"node_get_fsm_siblings_95":0,"node_get_fsm_siblings_99":0,"node_get_fsm_siblings_mean":0,"node_get_fsm_siblings_median":0,"node_get_fsm_time_100":0,"node_get_fsm_time_95":0,"node_get_fsm_time_99":0,"node_get_fsm_time_mean":0,"node_get_fsm_time_median":0,"node_gets":0,"node_gets_counter":0,"node_gets_counter_total":0,"node_gets_map":0,"node_gets_map_total":0,"node_gets_set":0,"node_gets_set_total":0,"node_gets_total":0,"node_put_fsm_active":0,"node_put_fsm_active_60s":0,"node_put_fsm_counter_time_100":0,"node_put_fsm_counter_time_95":0,"node_put_fsm_counter_time_99":0,"node_put_fsm_counter_time_mean":0,"node_put_fsm_counter_time_median":0,"node_put_fsm_in_rate":0,"node_put_fsm_map_time_100":0,"node_put_fsm_map_time_95":0,"node_put_fsm_map_time_99":0,"node_put_fsm_map_time_mean":0,"node_put_fsm_map_time_median":0,"node_put_fsm_out_rate":0,"node_put_fsm_rejected":0,"node_put_fsm_rejected_60s":0,"node_put_fsm_rejected_total":0,"node_put_fsm_set_time_100":0,"node_put_fsm_set_time_95":0,"node_put_fsm_set_time_99":0,"node_put_fsm_set_time_mean":0,"node_put_fsm_set_time_median":0,"node_put_fsm_time_100":0,"node_put_fsm_time_95":0,"node_put_fsm_time_99":0,"node_put_fsm_time_mean":0,"node_put_fsm_time_median":0,"node_puts":0,"node_puts_counter":0,"node_puts_counter_total":0,"node_puts_map":0,"node_puts_map_total":0,"node_puts_set":0,"node_puts_set_total":0,"node_puts_total":0,"nodename":"riak@127.0.0.1","object_counter_merge":0,"object_counter_merge_time_100":0,"object_counter_merge_time_95":0,"object_counter_merge_time_99":0,"object_counter_merge_time_mean":0,"object_counter_merge_time_median":0,"object_counter_merge_total":0,"object_map_merge":0,"object_map_merge_time_100":0,"object_map_merge_time_95":0,"object_map_merge_time_99":0,"object_map_merge_time_mean":0,"object_map_merge_time_median":0,"object_map_merge_total":0,"object_merge":0,"object_merge_time_100":0,"object_merge_time_95":0,"object_merge_time_99":0,"object_merge_time_mean":0,"object_merge_time_median":0,"object_merge_total":0,"object_set_merge":0,"object_set_merge_time_100":0,"object_set_merge_time_95":0,"object_set_merge_time_99":0,"object_set_merge_time_mean":0,"object_set_merge_time_median":0,"object_set_merge_total":0,"pbc_active":0,"pbc_connects":0,"pbc_connects_total":0,"pipeline_active":0,"pipeline_create_count":0,"pipeline_create_error_count":0,"pipeline_create_error_one":0,"pipeline_create_one":0,"postcommit_fail":0,"precommit_fail":0,"read_repairs":0,"read_repairs_counter":0,"read_repairs_counter_total":0,"read_repairs_fallback_notfound_count":"undefined","read_repairs_fallback_notfound_one":"undefined","read_repairs_fallback_outofdate_count":"undefined","read_repairs_fallback_outofdate_one":"undefined","read_repairs_map":0,"read_repairs_map_total":0,"read_repairs_primary_notfound_count":"undefined","read_repairs_primary_notfound_one":"undefined","read_repairs_primary_outofdate_count":"undefined","read_repairs_primary_outofdate_one":"undefined","read_repairs_set":0,"read_repairs_set_total":0,"read_repairs_total":0,"rebalance_delay_last":0,"rebalance_delay_max":0,"rebalance_delay_mean":0,"rebalance_delay_min":0,"rejected_handoffs":0,"riak_kv_vnodeq_max":0,"riak_kv_vnodeq_mean":0.0,"riak_kv_vnodeq_median":0,"riak_kv_vnodeq_min":0,"riak_kv_vnodeq_total":0,"riak_kv_vnodes_running":64,"riak_pipe_vnodeq_max":0,"riak_pipe_vnodeq_mean":0.0,"riak_pipe_vnodeq_median":0,"riak_pipe_vnodeq_min":0,"riak_pipe_vnodeq_total":0,"riak_pipe_vnodes_running":64,"ring_creation_size":64,"ring_members":["riak@127.0.0.1"],"ring_num_partitions":64,"ring_ownership":"[{\'riak@127.0.0.1\',64}]","rings_reconciled":0,"rings_reconciled_total":0,"search_index_fail_count":0,"search_index_fail_one":0,"search_index_latency_95":0,"search_index_latency_99":0,"search_index_latency_999":0,"search_index_latency_max":0,"search_index_latency_mean":0,"search_index_latency_median":0,"search_index_latency_min":0,"search_index_throughput_count":0,"search_index_throughput_one":0,"search_query_fail_count":0,"search_query_fail_one":0,"search_query_latency_95":0,"search_query_latency_99":0,"search_query_latency_999":0,"search_query_latency_max":0,"search_query_latency_mean":0,"search_query_latency_median":0,"search_query_latency_min":0,"search_query_throughput_count":0,"search_query_throughput_one":0,"set_actor_counts_100":0,"set_actor_counts_95":0,"set_actor_counts_99":0,"set_actor_counts_mean":0,"set_actor_counts_median":0,"skipped_read_repairs":0,"skipped_read_repairs_total":0,"storage_backend":"riak_kv_eleveldb_backend","sys_driver_version":"2.2","sys_global_heaps_size":"deprecated","sys_heap_type":"private","sys_logical_processors":8,"sys_monitor_count":252,"sys_otp_release":"R16B02_basho8","sys_port_count":48,"sys_process_count":1640,"sys_smp_support":true,"sys_system_architecture":"x86_64-apple-darwin12.4.0","sys_system_version":"Erlang R16B02_basho8 (erts-5.10.3) [source] [64-bit] [smp:8:8] [async-threads:64] [kernel-poll:true] [frame-pointer] [dtrace]","sys_thread_pool_size":64,"sys_threads_enabled":true,"sys_wordsize":8,"vnode_counter_update":0,"vnode_counter_update_time_100":0,"vnode_counter_update_time_95":0,"vnode_counter_update_time_99":0,"vnode_counter_update_time_mean":0,"vnode_counter_update_time_median":0,"vnode_counter_update_total":0,"vnode_get_fsm_time_100":0,"vnode_get_fsm_time_95":0,"vnode_get_fsm_time_99":0,"vnode_get_fsm_time_mean":0,"vnode_get_fsm_time_median":0,"vnode_gets":0,"vnode_gets_total":0,"vnode_index_deletes":0,"vnode_index_deletes_postings":0,"vnode_index_deletes_postings_total":0,"vnode_index_deletes_total":0,"vnode_index_reads":0,"vnode_index_reads_total":0,"vnode_index_refreshes":0,"vnode_index_refreshes_total":0,"vnode_index_writes":0,"vnode_index_writes_postings":0,"vnode_index_writes_postings_total":0,"vnode_index_writes_total":0,"vnode_map_update":0,"vnode_map_update_time_100":0,"vnode_map_update_time_95":0,"vnode_map_update_time_99":0,"vnode_map_update_time_mean":0,"vnode_map_update_time_median":0,"vnode_map_update_total":0,"vnode_put_fsm_time_100":0,"vnode_put_fsm_time_95":0,"vnode_put_fsm_time_99":0,"vnode_put_fsm_time_mean":0,"vnode_put_fsm_time_median":0,"vnode_puts":0,"vnode_puts_total":0,"vnode_set_update":0,"vnode_set_update_time_100":0,"vnode_set_update_time_95":0,"vnode_set_update_time_99":0,"vnode_set_update_time_mean":0,"vnode_set_update_time_median":0,"vnode_set_update_total":0,"write_once_merge":0,"write_once_put_objsize_100":0,"write_once_put_objsize_95":0,"write_once_put_objsize_99":0,"write_once_put_objsize_mean":0,"write_once_put_objsize_median":0,"write_once_put_time_100":0,"write_once_put_time_95":0,"write_once_put_time_99":0,"write_once_put_time_mean":0,"write_once_put_time_median":0,"write_once_puts":0,"write_once_puts_total":0,"disk":[{"id":"/","size":487401624,"used":54},{"id":"/Volumes/VirtualBox","size":129156,"used":87}],"riak_auth_mods_version":"2.0.1-0-g31b8b30","erlydtl_version":"0.7.0","riak_control_version":"2.1.1-0-g5898c40","cluster_info_version":"2.0.2-0-ge231144","yokozuna_version":"2.1.0-0-gcb41c27","ibrowse_version":"4.0.2","riak_search_version":"2.0.2-0-g8fe4a8c","merge_index_version":"2.0.0-0-gb701dde","riak_kv_version":"2.1.0-0-g6e88b24","riak_api_version":"2.1.1-2-g94a9485","riak_pb_version":"2.1.0.2-0-g620bc70","protobuffs_version":"0.8.1p5-0-gf88fc3c","riak_dt_version":"2.1.0-2-ga2986bc","sidejob_version":"2.0.0-0-gc5aabba","riak_pipe_version":"2.1.0-2-gc2d7d28","riak_core_version":"2.1.1-0-g429c22d","exometer_core_version":"1.0.0-basho2-0-gb47a5d6","poolboy_version":"0.8.1p3-0-g8bb45fb","pbkdf2_version":"2.0.0-0-g7076584","eleveldb_version":"2.1.0-0-ga36dbd6","clique_version":"0.2.6-0-g40072d2","bitcask_version":"1.7.0","basho_stats_version":"1.0.3","webmachine_version":"1.10.8-0-g7677c24","mochiweb_version":"2.9.0","inets_version":"5.9.6","xmerl_version":"1.3.4","erlang_js_version":"1.3.0-0-g07467d8","runtime_tools_version":"1.8.12","os_mon_version":"2.2.13","riak_sysmon_version":"2.0.0","ssl_version":"5.3.1","public_key_version":"0.20","crypto_version":"3.1","asn1_version":"2.0.3","sasl_version":"2.3.3","lager_version":"2.0.3","goldrush_version":"0.1.6","compiler_version":"4.9.3","syntax_tools_version":"1.6.11","stdlib_version":"1.19.3","kernel_version":"2.16.3"}'
    send_response(requestHandler, payload, 'application/json')

def refresh_buckets(requestHandler):
    requestHandler.send_response(202)
    requestHandler.end_headers()

def list_buckets(requestHandler):
    payload = '{"buckets":{"total":4,"count":4,"created":"2015-10-08 21:22:55","buckets":["zip3_inv_indexes","zip_inv","zombies","geohash_inv"]},"links":{"self":"/explore/clusters/default/bucket_types/default/buckets"}}'
    send_response(requestHandler, payload, 'application/json')

def bucket_props(requestHandler):
    payload = '{"props":{"name":"zombies","allow_mult":false,"basic_quorum":false,"big_vclock":50,"chash_keyfun":{"mod":"riak_core_util","fun":"chash_std_keyfun"},"dvv_enabled":false,"dw":"quorum","last_write_wins":false,"linkfun":{"mod":"riak_kv_wm_link_walker","fun":"mapreduce_linkfun"},"n_val":3,"notfound_ok":true,"old_vclock":86400,"postcommit":[],"pr":0,"precommit":[],"pw":0,"r":"quorum","rw":"quorum","small_vclock":50,"w":"quorum","write_once":false,"young_vclock":20}}'
    send_response(requestHandler, payload, 'application/json')

def refresh_keys(requestHandler):
    requestHandler.send_response(202)
    requestHandler.end_headers()

def list_keys(requestHandler):
    payload = '{"keys":{"total":10,"count":10,"created":"2015-10-08 21:27:25","keys":["452-16-5352","144-20-0815","486-42-8321","302-64-2796","402-06-0689","587-03-9892","554-82-0873","545-19-7119","420-43-9963","672-20-3139"]},"links":{"self":"/explore/clusters/default/bucket_types/default/buckets/zombies/keys"}}'
    send_response(requestHandler, payload, 'application/json')

def get_key(requestHandler):
    payload = '{"dna":"TGTTGACTTACGATGTCGGCATGGAAGTCCAACTGTCATTTAGAGCGTCTGAGCTGTATTGCACAATGAAGGGTAGCTACTCATAAGCGGAGGTGGATCATTGTCGTTGGGTATAAGCTGCCGCGCACTCAACATTGGGGATAGGCGGACACAATAAAGGTACTTGATACGACGTTTGTTTTCACTGCAGTGACAGGCAAAAATAGGTTGCGTTTTGGCCTGCCACTTAAAGTGCGTGGATCTAGCAGGCCGGAGAGCGTCACCTTGCGTACGGACTCACTTCTTGTAAGCTCATCCCCATAGTGGATTGGTTATCCTCTGGGAACTCAAGTAATCCGAGGTCCTCCATTCCAGACGCCGCTGGGTGATGCGGAAATGAGTCAG","sex":"female","name":"Lashanda L Bolinger","address":"389 Gladwell Street","city":"Stone Mountain","state":"GA","zip":"30083","phone":"903-228-9981","birthdate":"6/25/74","ssn":"452-16-5352","job":"Wildlife officer","bloodtype":"B+","weight":"179.1","height":"\"5 3\"\"\"","latitude":"33.422334","longitude":"-96.661448"}'
    requestHandler.send_response(200)
    requestHandler.send_header('Content-type', 'application/json')
    requestHandler.send_header('ETag', '2nzoPTkGBk0nzKwInlg0pF')
    requestHandler.send_header('Last-Modified', 'Tue, 23 Jun 2015 15:13:11 GMT')
    requestHandler.send_header('x-riak-index-zip_bin', '30083')
    requestHandler.send_header('X-Riak-Vclock', 'a85hYGBgzGDKBVI8ypz/frrM/fuGgUFdKIMpkTGPlaH9899zfFkA')
    requestHandler.end_headers()
    requestHandler.wfile.write(payload)
    requestHandler.wfile.close()

mappings = {
    '/test' : {'GET' : test},
    '/explore/clusters' : {'GET' : clusters},
    '/riak/clusters/default/search/index' : {'GET' : indexes},
    '/explore/clusters/default/nodes' : {'GET' : nodes},
    '/explore/clusters/default/bucket_types' : {'GET' : bucket_types},
    '/riak/nodes/riak@127.0.0.1/ping' :  {'GET' : riak_ping},
    '/riak/nodes/riak@127.0.0.1/stats' : {'GET' : riak_stats},
    '/explore/clusters/default/bucket_types/default/refresh_buckets/source/riak_kv' : {'POST' : refresh_buckets},
    '/explore/clusters/default/bucket_types/default/buckets' : {'GET' : list_buckets},
    '/riak/clusters/default/types/default/buckets/zombies/props' : {'GET' : bucket_props},
    '/explore/clusters/default/bucket_types/default/buckets/zombies/refresh_keys/source/riak_kv' : {'POST' : refresh_keys},
    '/explore/clusters/default/bucket_types/default/buckets/zombies/keys' : {'GET' : list_keys},
    '/riak/clusters/default/types/default/buckets/zombies/keys/452-16-5352' : {'GET' : get_key}
}
